<div class="container mx-auto px-4 py-8 text-center">
  <h1 class="text-2xl font-bold mb-6">おすすめのメニューはこれ！</h1>

  <% if @recipe %>
    <div class="bg-white rounded-lg shadow p-6 inline-block">
      <% if @recipe.image.attached? %>
        <%= image_tag @recipe.image.variant(resize_to_limit: [300, 300]).processed,
                      alt: @recipe.name,
                      class: "mx-auto mb-4 rounded-lg shadow" %>
      <% else %>
        <div class="mx-auto mb-4 w-64 h-64 flex items-center justify-center bg-gray-100 rounded-lg">
          <span class="text-gray-400">No Image</span>
        </div>
      <% end %>

      <!-- タイトルとハートを横並び -->
      <div class="flex items-center justify-center space-x-2 mb-2">
        <h2 class="text-lg font-semibold"><%= @recipe.name %></h2>

        <div id="favorite_button">
          <% if @active_user.present? %>
            <% if @active_user.favorited?(@recipe) %>
              <%= render "favorites/unfavorite", recipe: @recipe %>
            <% else %>
              <%= render "favorites/favorite", recipe: @recipe %>
            <% end %>
          <% else %>
            <%= link_to new_user_session_path, class: "flex items-center space-x-2 text-gray-400 hover:text-gray-600" do %>
              <svg xmlns="http://www.w3.org/2000/svg"
                    fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" 
                    class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" 
                    d="M21 8.25c0-2.485-2.014-4.5-4.5-4.5-1.74 0-3.29.99-4.05 2.457A4.494 4.494 0 008.25 3.75C5.764 3.75 3.75 5.765 3.75 8.25c0 7.5 8.25 11.25 8.25 11.25S21 15.75 21 8.25z"/>
              </svg>
            <% end %>
          <% end %>
        </div>
      </div>

      <p class="text-gray-600 mb-4"><%= @recipe.calories %> kcal</p>

      <div class="space-x-4">
        <% if @recipe.steps.present? %>
          <%= link_to "詳しいレシピ", recipe_path(@recipe), class: "font-semibold text-blue-600 hover:underline" %>
        <% end %>
        <%= link_to "もう一度", root_path, class: "text-gray-600 hover:underline" %>
      </div>
    </div>
  <% else %>
    <p class="text-gray-500">レシピが見つかりませんでした。</p>
  <% end %>
</div>

