<div class="container mx-auto px-4 py-8">
  <div class="bg-white rounded-lg shadow p-6 max-w-2xl mx-auto">
    <!-- レシピ名 -->
    <h1 class="text-2xl font-bold mb-4"><%= @recipe.name %></h1>

    <!-- カロリー -->
    <p class="text-gray-600 mb-6"><%= @recipe.calories %> kcal</p>

    <!-- 画像 -->
    <% if @recipe.image.attached? %>
      <%= image_tag @recipe.image.variant(resize_to_limit: [400, 400]).processed,
                    alt: @recipe.name,
                    class: "mx-auto mb-6 rounded-lg shadow" %>
    <% else %>
      <div class="w-64 h-64 mx-auto mb-6 flex items-center justify-center bg-gray-100 rounded-lg">
        <span class="text-gray-400">No Image</span>
      </div>
    <% end %>

    <div class="mt-4">
      <% if user_signed_in? %>
        <% if current_user.favorited?(@recipe) %>
          <%= render "favorites/unfavorite", recipe: @recipe %>
        <% else %>
          <%= render "favorites/favorite", recipe: @recipe %>
        <% end %>
      <% else %>
        <%= link_to new_user_session_path, class: "flex items-center space-x-2 text-gray-400 hover:text-gray-600" do %>
          <svg xmlns="http://www.w3.org/2000/svg"
                fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" 
                class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" 
                d="M21 8.25c0-2.485-2.014-4.5-4.5-4.5-1.74 0-3.29.99-4.05 2.457A4.494 4.494 0 008.25 3.75C5.764 3.75 3.75 5.765 3.75 8.25c0 7.5 8.25 11.25 8.25 11.25S21 15.75 21 8.25z"/>
          </svg>
        <% end %>
      <% end %>
    </div>

    <!-- 材料 -->
    <% if @recipe.ingredients.present? %>
      <h2 class="text-lg font-semibold mb-2">材料</h2>
      <ul class="list-disc list-inside mb-6 text-gray-700">
        <% @recipe.ingredients.each do |item| %>
          <li><%= item %></li>
        <% end %>
      </ul>
    <% end %>

    <!-- ギア -->
    <% if @recipe.gear.present? %>
      <h2 class="text-lg font-semibold mb-2">必要なギア</h2>
      <ul class="list-disc list-inside mb-6 text-gray-700">
        <% @recipe.gear.each do |g| %>
          <li><%= g %></li>
        <% end %>
      </ul>
    <% end %>

    <!-- 手順 -->
    <% if @recipe.steps.present? %>
      <h2 class="text-lg font-semibold mb-2">作り方</h2>
      <ol class="list-decimal list-inside mb-6 text-gray-700">
        <% @recipe.steps.each do |s| %>
          <li><%= s %></li>
        <% end %>
      </ol>
    <% end %>

    <!-- 戻るリンク -->
    <div class="flex justify-between text-sm">
      <%= link_to "← トップに戻る", root_path, class: "text-blue-600 hover:underline" %>
    </div>
  </div>
</div>
